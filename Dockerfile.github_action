FROM python:3.10-slim-bookworm as base

WORKDIR /app
ADD pyproject.toml .
ADD requirements.txt .
RUN apt-get update \
    && apt-get install git -y \
    && apt-get autoremove -y \
    && apt-get clean && rm -rf /var/lib/apt/lists/*
RUN pip install . && rm pyproject.toml requirements.txt
ENV PYTHONPATH=/app
ADD pr_agent pr_agent
ADD github_action/entrypoint.sh /
RUN chmod +x /entrypoint.sh
ENTRYPOINT ["/entrypoint.sh"]
